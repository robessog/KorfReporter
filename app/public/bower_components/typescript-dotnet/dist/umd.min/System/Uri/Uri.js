/*!
 * @author electricessence / https://github.com/electricessence/
 * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md
 * Based on: https://en.wikipedia.org/wiki/Uniform_Resource_Identifier
 */
!function(t){if("object"==typeof module&&"object"==typeof module.exports){var e=t(require,exports);void 0!==e&&(module.exports=e)}else"function"==typeof define&&define.amd&&define(["require","exports","../Types","../Uri/QueryParams","../Text/Utility","../Uri/Scheme","../Exceptions/ArgumentException","../Exceptions/ArgumentOutOfRangeException"],t)}(function(t,e){"use strict";function r(t,e){var r,n=0;for(e||(e={});r=g[n++];){var u=t[r];u&&(e[r]=u)}return e}function n(t){var e=t;if(p["default"].isString(e)){if(!e)return;if(e=h["default"][l.trim(e).toLowerCase().replace(/[^a-z0-9+.-]+$/g,w)],isNaN(e))throw new m["default"]("scheme",t,"Invalid scheme.")}if(p["default"].isNumber(e,!1)){if(e=h["default"][e],!e)throw new m["default"]("scheme",t,"Invalid scheme.");return e}}function u(t){if(!t.host){if(t.userInfo)throw new d["default"]("host","Cannot include user info when there is no host.");if(p["default"].isNumber(t.port,!1))throw new d["default"]("host","Cannot include a port when there is no host.")}var e=t.host||w;return e&&(t.userInfo&&(e=t.userInfo+q+e),isNaN(t.port)||(e+=":"+t.port),e=v+e),e}function i(t){return t&&(-1==t.indexOf(x)?x:w)+t}function o(t){return t&&(-1==t.indexOf(O)?O:w)+t}function s(t){var e=t.path,r=t.query;return w+(e&&(-1==e.indexOf(b)?b:w)+e||w)+(i(r)||w)}function f(t){var e=n(t.scheme),r=u(t),i=s(t),f=o(t.fragment);return w+(e&&e+":"||w)+(r||w)+(i||w)+(f||w)}function a(t,e){if(!t)return new d["default"]("url","Nothing to parse.");var u,i={};if(u=t.indexOf(O),-1!=u&&(i.fragment=t.substring(u),t=t.substring(0,u)),u=t.indexOf(x),-1!=u&&(i.query=t.substring(u),t=t.substring(0,u)),u=t.indexOf(v),-1!=u){var o=l.trim(t.substring(0,u)),s=/:$/;if(!s.test(o))return new d["default"]("url","Scheme was improperly formatted");o=l.trim(o.replace(s,w));try{i.scheme=n(o)||void 0}catch(f){return f}t=t.substring(u+2)}if(u=t.indexOf(b),-1!=u&&(i.path=t.substring(u)||void 0,t=t.substring(0,u)),u=t.indexOf(q),-1!=u&&(i.userInfo=t.substring(0,u)||void 0,t=t.substring(u+1)),u=t.indexOf(":"),-1!=u){var a=parseInt(l.trim(t.substring(u+1)));if(isNaN(a))return new d["default"]("url","Port was invalid.");i.port=a,t=t.substring(0,u)}return t=l.trim(t),t&&(i.host=t),e(r(i)),null}var p=t("../Types"),c=t("../Uri/QueryParams"),l=t("../Text/Utility"),h=t("../Uri/Scheme"),d=t("../Exceptions/ArgumentException"),m=t("../Exceptions/ArgumentOutOfRangeException"),y=function(){function t(t,e,r,u,s,f,a){var l=this;l.scheme=n(t)||null,l.userInfo=e||null,l.host=r||null,l.port=u||null,l.authority=l.getAuthority()||null,l.path=s||null,p["default"].isString(f)||(f=c.encode(f)),l.query=i(f)||null,Object.freeze(l.queryParams=l.query?c.parseToMap(l.query):{}),l.pathAndQuery=l.getPathAndQuery()||null,l.fragment=o(a)||null,l.absoluteUri=l.getAbsoluteUri(),l.baseUri=l.absoluteUri.replace(/[?#].*/,""),Object.freeze(l)}return t.prototype.equals=function(e){return this===e||this.absoluteUri==t.toString(e)},t.from=function(e,r){var n=!e||p["default"].isString(e)?t.parse(e):e;return new t(n.scheme||r&&r.scheme,n.userInfo||r&&r.userInfo,n.host||r&&r.host,isNaN(n.port)?r&&r.port:n.port,n.path||r&&r.path,n.query||r&&r.query,n.fragment||r&&r.fragment)},t.parse=function(t,e){void 0===e&&(e=!0);var r=null,n=a(t,function(t){r=t});if(e&&n)throw n;return r},t.tryParse=function(t,e){return!a(t,e)},t.copyOf=function(t){return r(t)},t.prototype.copyTo=function(t){return r(this,t)},t.prototype.updateQuery=function(e){var r=this.toMap();return r.query=e,t.from(r)},t.prototype.getAbsoluteUri=function(){return f(this)},t.prototype.getAuthority=function(){return u(this)},t.prototype.getPathAndQuery=function(){return s(this)},Object.defineProperty(t.prototype,"pathSegments",{get:function(){return this.path.match(/^[\/]|[^\/]*[\/]|[^\/]+$/g)},enumerable:!0,configurable:!0}),t.prototype.toMap=function(){return this.copyTo({})},t.prototype.toString=function(){return this.absoluteUri},t.toString=function(e){return e instanceof t?e.absoluteUri:f(e)},t.getAuthority=function(t){return u(t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=y,function(t){t[t.scheme=0]="scheme",t[t.userInfo=1]="userInfo",t[t.host=2]="host",t[t.port=3]="port",t[t.path=4]="path",t[t.query=5]="query",t[t.fragment=6]="fragment"}(e.Fields||(e.Fields={}));var g=e.Fields;Object.freeze(g);var b="/",v="//",x="?",O="#",w="",q="@"});
//# sourceMappingURL=Uri.js.map
