/*!
 * @author electricessence / https://github.com/electricessence/
 * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md
 * Based on code from: https://github.com/kriskowal/q
 */
define(["require","exports","../Types","../Collections/LinkedList","../Collections/Queue"],function(e,t,n,o,i){"use strict";function r(){for(var e;e=m.first;){var t=e.value,n=t.domain;e.remove(),n&&n.enter(),u(t.task,n)}for(var o;o=l.dequeue();)u(o);d=!1}function u(e,t){try{e()}catch(n){if(a)throw t&&t.exit(),setTimeout(r,0),t&&t.enter(),n;setTimeout(function(){throw n},0)}t&&t.exit()}function s(){d||(d=!0,f())}var f,c,a=!1,d=!1,m=new o["default"],l=new i["default"];if(function(e){function t(e,t){if(n["default"].isNumber(t,!1)&&t>=0){var o=0,i=function(){return o?(clearTimeout(o),o=0,!0):!1};return o=setTimeout(function(){i(),e()},t),i}var r={task:e,domain:a&&process.domain};return m.add(r),s(),function(){return!!m.remove(r)}}function o(e){l.enqueue(e),s()}e.defer=t,e.runAfterDeferred=o}(c||(c={})),n["default"].isObject(process)&&"[object process]"===process.toString()&&process.nextTick)a=!0,f=function(){process.nextTick(r)};else if("function"==typeof setImmediate)f="undefined"!=typeof window?setImmediate.bind(window,r):function(){setImmediate(r)};else if("undefined"!=typeof MessageChannel){var p=new MessageChannel;p.port1.onmessage=function(){f=v,p.port1.onmessage=r,r()};var v=function(){p.port2.postMessage(0)};f=function(){setTimeout(r,0),v()}}else f=function(){setTimeout(r,0)};Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=c});
//# sourceMappingURL=TaskScheduler.js.map
